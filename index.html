<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ReadHelper - 文档阅读助手</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- 顶部状态栏 -->
    <div class="top-status-bar">
      <div class="status-info">
        <span class="brand-tag">@CJLASS</span>
        <span class="divider">|</span>
        <span class="book-count"
          >📚 正在读 <strong id="totalBooksRead">0</strong> 本书</span
        >
        <span class="divider">|</span>
        <span class="current-datetime" id="currentDateTime"></span>
      </div>
    </div>
    <div class="app-container">
      <!-- 侧边栏 -->
      <div class="sidebar" id="sidebar">
        <!-- 图标栏（收起时显示） -->
        <div class="sidebar-icons">
          <div class="sidebar-icon-header">
            <span class="icon-logo"></span>
          </div>
          <div class="sidebar-icon-spacer"></div>
          <button class="sidebar-icon-btn" id="settingsBtn" title="设置">
            ⚙️
          </button>
          <button
            class="sidebar-icon-btn sidebar-toggle-btn"
            id="sidebarToggle"
            title="展开/收起侧边栏"
          >
            »
          </button>
        </div>

        <!-- 完整内容（展开时显示） -->
        <div class="sidebar-content">
          <div class="sidebar-header">
            <h2>📚 ReadHelper</h2>
          </div>

          <div class="sidebar-section">
            <button class="btn btn-primary" id="openFileBtn">
              📂 打开文档
            </button>
          </div>

          <!-- 最近打开的文档 -->
          <div class="sidebar-section history-section">
            <div class="section-header">
              <h3>🕐 最近打开</h3>
              <button
                class="btn-text"
                id="clearHistoryBtn"
                title="清除所有历史"
              >
                清除
              </button>
            </div>
            <div id="historyList" class="history-list">
              <p class="empty-state">暂无历史记录</p>
            </div>
          </div>

          <!-- 笔记列表 -->
          <div class="sidebar-section collapsible-section">
            <div class="section-header collapsible-header" id="notesHeader">
              <h3>📝 笔记</h3>
              <span class="collapse-icon">▼</span>
            </div>
            <div id="notesList" class="notes-list collapsible-content">
              <p class="empty-state">暂无笔记</p>
            </div>
          </div>

          <!-- 书签列表 -->
          <div class="sidebar-section collapsible-section">
            <div class="section-header collapsible-header" id="bookmarksHeader">
              <h3>🔖 书签</h3>
              <span class="collapse-icon">▼</span>
            </div>
            <div id="bookmarksList" class="bookmarks-list collapsible-content">
              <p class="empty-state">暂无书签</p>
            </div>
          </div>
        </div>
      </div>

      <!-- 主内容区 -->
      <div class="main-content">
        <!-- 固定头部区域 -->
        <div class="fixed-header">
          <div class="toolbar">
            <div class="file-info">
              <span id="fileName">未打开文档</span>
            </div>
          </div>
          <!-- 功能工具栏 -->
          <div class="action-toolbar" id="actionToolbar">
            <div class="zoom-controls" id="zoomControls">
              <button class="btn btn-sm" id="mainZoomOut" title="缩小">
                −
              </button>
              <span class="zoom-level" id="mainZoomLevel">150%</span>
              <button class="btn btn-sm" id="mainZoomIn" title="放大">+</button>
              <span class="page-info" id="mainPageInfo"></span>
            </div>
            <div class="toolbar-actions">
              <button
                class="btn btn-icon"
                id="addNoteBtn"
                title="添加笔记"
                disabled
              >
                ✏️ 笔记
              </button>
              <button
                class="btn btn-icon"
                id="addBookmarkBtn"
                title="添加书签"
                disabled
              >
                🔖 书签
              </button>
              <button
                class="btn btn-icon"
                id="translateBtn"
                title="翻译选中文本"
                disabled
              >
                🌐 翻译
              </button>
              <button
                class="btn btn-icon"
                id="readBtn"
                title="朗读选中文本"
                disabled
              >
                🔊 朗读
              </button>
              <button
                class="btn btn-icon btn-extract"
                id="extractBtn"
                title="框选提取文本"
                disabled
              >
                ✂️ 框选
              </button>
            </div>
          </div>
        </div>

        <div class="content-wrapper">
          <div class="content-area">
            <div id="documentViewer" class="document-viewer">
              <div class="welcome-screen">
                <div class="welcome-content">
                  <h1>欢迎使用 ReadHelper</h1>
                  <p>一个功能强大的文档阅读助手</p>
                  <ul class="feature-list">
                    <li>📄 支持多种文档格式 (PDF, TXT, Markdown, HTML)</li>
                    <li>🌐 智能翻译功能</li>
                    <li>📝 便捷的笔记记录</li>
                    <li>🎨 文本高亮标记</li>
                    <li>🔖 书签管理</li>
                  </ul>
                  <button class="btn btn-large btn-primary" id="openFileBtn2">
                    开始使用 - 打开文档
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- 右侧提取文本面板 -->
          <div class="extraction-panel hidden" id="extractionPanel">
            <div class="extraction-panel-header">
              <h3>📋 提取记录</h3>
              <div class="extraction-panel-actions">
                <button
                  class="btn btn-sm"
                  id="clearExtractions"
                  title="清空所有"
                >
                  清空
                </button>
                <button class="btn-close" id="closeExtractionPanel">×</button>
              </div>
            </div>
            <div class="extraction-list" id="extractionList">
              <p class="empty-state">点击「框选」按钮后在PDF上画框选择区域</p>
            </div>
          </div>
        </div>

        <!-- 翻译面板 -->
        <div id="translationPanel" class="translation-panel hidden">
          <div class="panel-header">
            <h3>翻译结果</h3>
            <div class="panel-header-actions">
              <button
                class="btn-icon-header"
                id="saveTranslationAsNote"
                title="保存为笔记"
                disabled
              >
                📝
              </button>
              <button class="btn-close" id="closeTranslation">×</button>
            </div>
          </div>
          <div class="panel-content">
            <div class="original-text">
              <h4>原文：</h4>
              <p id="originalText"></p>
            </div>
            <div class="translated-text">
              <h4>译文：</h4>
              <p id="translatedText">翻译中...</p>
            </div>
          </div>
        </div>

        <!-- 笔记编辑面板 -->
        <div id="notePanel" class="note-panel hidden">
          <div class="panel-header">
            <h3>添加笔记</h3>
            <button class="btn-close" id="closeNote">×</button>
          </div>
          <div class="panel-content">
            <div class="note-context">
              <h4>选中文本：</h4>
              <p id="noteContext"></p>
            </div>
            <div class="note-input">
              <h4>笔记内容：</h4>
              <textarea
                id="noteContent"
                rows="5"
                placeholder="输入您的笔记..."
              ></textarea>
            </div>
            <div class="panel-actions">
              <button class="btn btn-secondary" id="cancelNote">取消</button>
              <button class="btn btn-primary" id="saveNote">保存</button>
            </div>
          </div>
        </div>

        <!-- TTS 朗读控制面板 -->
        <div id="ttsPanel" class="tts-panel hidden">
          <div class="panel-header">
            <h3>🔊 文本朗读</h3>
            <button class="btn-close" id="closeTTS">×</button>
          </div>
          <div class="panel-content">
            <div class="tts-text-preview">
              <h4>朗读内容：</h4>
              <p id="ttsText"></p>
            </div>
            <div class="tts-info">
              <span>语言：<strong id="ttsLanguage">自动检测</strong></span>
              <span id="ttsStatus">准备就绪</span>
            </div>
            <div class="tts-controls">
              <button class="btn btn-primary" id="ttsPlayBtn" title="播放">
                ▶️ 播放
              </button>
              <button
                class="btn btn-primary hidden"
                id="ttsPauseBtn"
                title="暂停"
              >
                ⏸️ 暂停
              </button>
              <button class="btn btn-secondary" id="ttsStopBtn" title="停止">
                ⏹️ 停止
              </button>
            </div>
            <div class="tts-settings">
              <label>语速：</label>
              <input
                type="range"
                id="ttsRate"
                min="0.5"
                max="2"
                step="0.1"
                value="0.8"
              />
              <span id="ttsRateValue">0.8x</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 设置模态框 -->
    <div class="settings-overlay hidden" id="settingsOverlay"></div>
    <div class="settings-modal hidden" id="settingsModal">
      <div class="settings-header">
        <h3>⚙️ 设置</h3>
        <button class="close-btn" id="closeSettingsBtn">×</button>
      </div>
      <div class="settings-content">
        <div class="settings-section">
          <h4>DeepSeek API</h4>
          <p class="settings-desc">AI 文本格式化功能（提取文本智能排版）</p>
          <div class="settings-row">
            <label for="deepseekApiKey">API Key:</label>
            <input
              type="password"
              id="deepseekApiKey"
              placeholder="输入 DeepSeek API Key"
            />
            <button class="btn-icon" id="toggleDeepseekKey" title="显示/隐藏">
              👁️
            </button>
          </div>
          <div class="settings-row compact">
            <label>启用:</label>
            <label class="switch">
              <input type="checkbox" id="deepseekEnabled" checked />
              <span class="slider"></span>
            </label>
          </div>
        </div>
        <div class="settings-section">
          <h4>Google Cloud Translation API</h4>
          <p class="settings-desc">翻译功能</p>
          <div class="settings-row">
            <label for="googleApiKey">API Key:</label>
            <input
              type="password"
              id="googleApiKey"
              placeholder="输入 Google Cloud API Key"
            />
            <button class="btn-icon" id="toggleGoogleKey" title="显示/隐藏">
              👁️
            </button>
          </div>
        </div>
        <div class="settings-section">
          <h4>翻译设置</h4>
          <div class="settings-row">
            <label for="defaultTargetLang">默认目标语言:</label>
            <select id="defaultTargetLang">
              <option value="zh-CN">简体中文</option>
              <option value="zh-TW">繁体中文</option>
              <option value="en">英文</option>
              <option value="ja">日文</option>
              <option value="ko">韩文</option>
            </select>
          </div>
        </div>
      </div>
      <div class="settings-footer">
        <button class="btn btn-secondary" id="cancelSettingsBtn">取消</button>
        <button class="btn btn-primary" id="saveSettingsBtn">保存</button>
      </div>
    </div>

    <script src="renderer.js"></script>
  </body>
</html>
